{
  "name": "funnel_audit",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -352,
        -192
      ],
      "id": "b865c24d-7776-4aa3-a6d2-a35e1577b191",
      "name": "When clicking ‘Execute workflow’"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1GR5E9rsU8hJvG7zKBdixZQJIIisEy9-nsYBLPaC67ac/edit?gid=1637434014#gid=1637434014",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1637434014,
          "mode": "list",
          "cachedResultName": "input_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1GR5E9rsU8hJvG7zKBdixZQJIIisEy9-nsYBLPaC67ac/edit#gid=1637434014"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        -112,
        -192
      ],
      "id": "b2a2cfce-57fb-46bc-a99b-846234af63e5",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ApCak9nV1ojGAPgu",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "url": "https://shot.screenshotapi.net/screenshot",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "token",
              "value": "your_key"
            },
            {
              "name": "url",
              "value": "={{ $json.URL }}"
            },
            {
              "name": "block_cookie_banners",
              "value": "true"
            }
          ]
        },
        "options": {
          "allowUnauthorizedCerts": false
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        448,
        -112
      ],
      "id": "131df582-95c4-46f5-8684-13fe60a7f03a",
      "name": "HTTP Request",
      "retryOnFail": true
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8890a919-e467-49c3-ad08-b404b4e57ad0",
              "name": "URL",
              "value": "={{ $('Get row(s) in sheet').item.json.URL }}",
              "type": "string"
            },
            {
              "id": "ce1edc9f-3659-47db-98f2-8728070a0759",
              "name": "Analysis",
              "value": "={{ $json.content[0].text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        928,
        -208
      ],
      "id": "7fb7c716-1f95-498b-8af6-958b06708049",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        112,
        -208
      ],
      "id": "c013c069-8c8c-4dee-b8d1-a35a89f72a46",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1296,
        -208
      ],
      "id": "22787493-873c-4c86-a469-a914874f71db",
      "name": "Wait",
      "webhookId": "20c64c37-b4ca-448f-9056-e48adba12ef0"
    },
    {
      "parameters": {
        "resource": "image",
        "modelId": {
          "__rl": true,
          "value": "claude-sonnet-4-5-20250929",
          "mode": "list",
          "cachedResultName": "claude-sonnet-4-5-20250929"
        },
        "text": "You are a UX Researcher specializing in detailed design audit.\nAnalyze the attached screenshot of this page that could be conversion frictions and add your recommendations. Keep your response within 50 words.",
        "imageUrls": "={{ $json.screenshot }}",
        "options": {
          "maxTokens": 1024
        }
      },
      "type": "@n8n/n8n-nodes-langchain.anthropic",
      "typeVersion": 1,
      "position": [
        752,
        -208
      ],
      "id": "f060b8f8-e64d-4920-be8d-80cb94e10874",
      "name": "Analyze image",
      "retryOnFail": true,
      "credentials": {
        "anthropicApi": {
          "id": "enuWMHPTYZyrhglr",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1GR5E9rsU8hJvG7zKBdixZQJIIisEy9-nsYBLPaC67ac/edit?gid=1637434014#gid=1637434014",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1637434014,
          "mode": "list",
          "cachedResultName": "input_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1GR5E9rsU8hJvG7zKBdixZQJIIisEy9-nsYBLPaC67ac/edit#gid=1637434014"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "URL": "={{ $json.URL }}",
            "Analysis": "={{ $json.Analysis }}"
          },
          "matchingColumns": [
            "URL"
          ],
          "schema": [
            {
              "id": "Page name",
              "displayName": "Page name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "URL",
              "displayName": "URL",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Analysis",
              "displayName": "Analysis",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1120,
        -208
      ],
      "id": "df5c53a4-fa61-4c62-9297-18f2dbc4cbe3",
      "name": "Update row in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ApCak9nV1ojGAPgu",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "https://docs.google.com/spreadsheets/d/1GR5E9rsU8hJvG7zKBdixZQJIIisEy9-nsYBLPaC67ac/edit?gid=1637434014#gid=1637434014",
          "mode": "url"
        },
        "sheetName": {
          "__rl": true,
          "value": 1637434014,
          "mode": "list",
          "cachedResultName": "input_sheet",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1GR5E9rsU8hJvG7zKBdixZQJIIisEy9-nsYBLPaC67ac/edit#gid=1637434014"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        336,
        -400
      ],
      "id": "f1d67729-f465-4f36-9a18-57af39d87d81",
      "name": "Get row(s) in sheet1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "ApCak9nV1ojGAPgu",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\n\n// Start the Report with a Title and Date\nlet report = `UX AUDIT REPORT\\nDate: ${new Date().toLocaleDateString()}\\n`;\nreport += \"================================================\\n\\n\";\n\nfor (const item of items) {\n  // 1. Get the data (Use your actual column headers here)\n  const url = item.json.URL || \"Page URL\"; \n  const analysis = item.json.Analysis || \"Analysis pending...\";\n\n  // 2. Format the block\n  report += `PAGE: ${url}\\n`;\n  report += `STATUS: Audited\\n`;\n  report += `------------------------------------------------\\n`;\n  report += `${analysis}\\n`;\n  report += `\\n\\n`; // Add double spacing between sections\n}\n\n// Output the single text block\nreturn [{ json: { report_text: report } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        544,
        -400
      ],
      "id": "319179a0-5c21-4756-ac8f-54f58be4262f",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "operation": "update",
        "documentURL": "https://docs.google.com/document/d/1aKq8um0xOOzrIia9jaux4-Mny__MYrDTTmYdAJucFAo/edit?tab=t.0",
        "actionsUi": {
          "actionFields": [
            {
              "action": "insert",
              "locationChoice": "location"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.googleDocs",
      "typeVersion": 2,
      "position": [
        752,
        -400
      ],
      "id": "1f2a779e-3c7b-4fed-9af0-02768aae8398",
      "name": "Update a document",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "Gd6Ov9lIklqFYrzP",
          "name": "Google Docs account 2"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When clicking ‘Execute workflow’": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Analyze image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Update row in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          },
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze image": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Update row in sheet": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet1": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Update a document",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "1da6da7b-7af2-4761-9a71-a3d224468d8c",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "ba1c05e80133909f78de73359dd8c44589ba9110128cf010a937430dbda2aa58"
  },
  "id": "OTk1cOh3TesBAneY",
  "tags": []
}